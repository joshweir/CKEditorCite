!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e){!function(t){"use strict";var e,n,i,o,a,r,s,d,u,c,l=(e=function(t,e,n){return n.replace(e,t)},function t(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(void 0,i):function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.apply(void 0,[].concat(i,n))}}),f=function(t,e,n){var i=new RegExp("<"+e,"g"),o="<"+t,a=new RegExp("</"+e,"g"),r="</"+t,s=l(o)(i);return function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reverse().reduce(function(t,e){return function(n){return e(t(n))}},function(t){return t})}(l(r)(a),s)(n)},h=function(t){return f("span","div",t)},g=[],m="[data-selection-bookmark]";jQuery.fn.reverse=[].reverse,CKEDITOR.plugins.add("cite",{requires:"widget,contextmenu,wysiwygarea,dialogui,dialog,basicstyles,menu,contextmenu,floatpanel,panel",icons:"cite",init:function(t){if(void 0===window.jQuery)return console.warn("jQuery required but undetected so quitting cite."),!1;CKEDITOR.dtd.$editable.span=1,(n=t).addContentsCss(this.path+"styles/plugin.css"),this.initWidgets(),this.setupEditorEventHandlers()},initWidgets:function(){this.registerWidgets(),this.addWidgetCommandsButtonsAndDialogs()},registerWidgets:function(){n.widgets.add("footnotes",{requiredContent:"section(footnotes)",upcast:function(t){return"section"===t.name&&t.hasClass("footnotes")},editables:this.retrieveFootnotesWidgetEditableElements(t("<div>"+n.element.$.textContent+"</div>")),draggable:!1}),n.widgets.add("footnotemarker",{requiredContent:"span[data-citation]",upcast:function(t){return t.classes.indexOf("sup")>-1&&"undefined"!=t.attributes["data-footnote-id"]},draggable:!1})},retrieveFootnotesWidgetEditableElements:function(e){var i={header:{selector:"header > *",allowedContent:"span[*](*); strong em sub sup;div[*](sup)"}},o=1,a=n.config.footnotesPrefix?"-"+n.config.footnotesPrefix:"";return e.find(".footnotes li").each(function(){i["footnote_"+o]={selector:"#footnote"+a+"-"+t(this).attr("data-footnote-id")+" .cite",allowedContent:"a[href]; cite[*](*); span[*](*); strong em br i"},o++}),i},addWidgetCommandsButtonsAndDialogs:function(){n.addCommand("cite",new CKEDITOR.dialogCommand("citeDialog",{allowedContent:"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)",requiredContent:"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)"})),n.addCommand("intext_cite",new CKEDITOR.dialogCommand("intextCiteDialog",{allowedContent:"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)",requiredContent:"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)"})),n.ui.addButton("Cite",{label:"Insert Citation",command:"cite",toolbar:"insert"}),CKEDITOR.dialog.add("citeDialog",this.path+"dialogs/cite.js"),CKEDITOR.dialog.add("intextCiteDialog",this.path+"dialogs/intext_cite.js")},setupEditorEventHandlers:function(){this.retrieveContentsAndReorderMarkersOnInstanceReady(),this.moveCursorAfterFocusedWidgetOnEditorBlur(),this.reorderMarkersOnEditorChange(),this.updateMarkersWithCurrentCitationValuesOnEditorChange(),this.invokeIntextCiteDialogOnDoubleClick(),this.initMenuOnInstanceReady()},retrieveContentsAndReorderMarkersOnInstanceReady:function(){var e=this;n.on("instanceReady",function(o){i=t(n.editable().$),e.reorderMarkers("startup"),i=t(n.editable().$)})},moveCursorAfterFocusedWidgetOnEditorBlur:function(){n.on("blur",function(){n.widgets.focused&&(t('<span class="dummyF">&nbsp;</span>').insertAfter(t(n.widgets.focused.element.$).parent()),this.moveCursorAfterFocusedWidget())})},reorderMarkersOnEditorChange:function(){var t,e=this;n.on("change",function(n){clearTimeout(t),t=setTimeout(function(){var t=(new Date).getTime();localStorage.getItem("reordering_markers")||localStorage.setItem("reordering_markers",t),n.editor.getSelection()&&n.editor.getSelection().getStartElement()&&(e.editingAFootnote(n)||(localStorage.getItem("reordering_markers")==t&&setTimeout(function(){e.reorderMarkers("change")},0),setTimeout(function(){localStorage.removeItem("reordering_markers")},200)))},1e3)})},editingAFootnote:function(t){var e=t.editor.getSelection().getStartElement().getAscendant("section");return!(!e||-1===e.$.className.indexOf("footnotes"))},updateMarkersWithCurrentCitationValuesOnEditorChange:function(){var e=this;n.on("change",function(n){var o=i.find(".footnotes header h2").html();i.find(".footnotes li .cite").each(function(){var n=t(this),a=t(this).parent("li").attr("data-footnote-id");i.find(".sup[data-footnote-id="+a+"]").each(function(){t(this).attr("data-citation-modified",e.replaceQuotesWithPlaceholder(n.html())),o&&t(this).attr("data-footnotes-heading",e.replaceQuotesWithPlaceholder(o))})})})},invokeIntextCiteDialogOnDoubleClick:function(){n.on("doubleclick",function(t){var e=n.getSelection().getStartElement();e.hasClass("cke_widget_focused")&&e.find(".sup[data-footnote-id]").$.length&&n.execCommand("intext_cite")})},initMenuOnInstanceReady:function(){CKEDITOR.on("instanceReady",function(t){if(!n._.menuItems.editCiteCmd){n.addMenuGroup("cite");n.contextMenu.addListener(function(t,e){if(t.getAscendant(function(t){try{return t.hasClass("cke_widget_focused")&&t.find(".sup[data-footnote-id]").$.length}catch(t){return null}},!0))return{editCiteCmd:CKEDITOR.TRISTATE_ON}}),n.addMenuItems({editCiteCmd:{label:"Edit In-text Citation",command:"intext_cite",group:"cite",order:2}}),n.removeMenuItem("paste"),n.removeMenuItem("copy"),n.removeMenuItem("cut")}})},setCursorBookmark:function(){if(n&&i)return this.removeExistingCursorBookmark(),this.createCursorBookmarkReturnContainingElement()},removeExistingCursorBookmark:function(){i.find(m).remove(),i.find("span").filter(function(){return"&nbsp;"===t(this).html()}).remove()},createCursorBookmarkReturnContainingElement:function(){var e=n.getSelection(),i=e.createBookmarks();return i[0]&&t(i[0].startNode.$).attr("data-selection-bookmark","1"),e.getRanges()[0]},isValidHtml:function(t){return!0},updateCitationsByExternalId:function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)this.citationUpdateHasRequiredData(t[e])&&(this.updateFootnotesByExternalId(t[e]),this.updateInlineCitationsByExternalId(t[e]));t.length&&this.updateInlineCitationBrackets(t),this.reorderMarkers("build"),n.focus()}},citationUpdateHasRequiredData:function(t){return t instanceof Object&&t.externalId&&t.externalId.length>0&&t.citation&&t.citation.length>0},updateFootnotesByExternalId:function(e){var n=this;i.find(".footnotes li[data-footnote-id][data-ext-id="+e.externalId+"]").each(function(){var i=t(this);e.inlineCitation&&e.inlineCitation.length>0?i.attr("data-inline-citation",n.removeOuterBrackets(n.replaceQuotesWithPlaceholder(h(e.inlineCitation)))):i.removeAttr("data-inline-citation"),i.find(".cite").html(h(e.citation))})},updateInlineCitationsByExternalId:function(e){var n=this;i.find(".sup[data-footnote-id][data-ext-id="+e.externalId+"]").each(function(){var i=t(this),o=i.find("a"),a=n.replaceQuotesWithPlaceholder(h(e.citation));if(i.attr("data-citation",a).attr("data-citation-modified",a),o.attr("data-citation",a).attr("data-citation-modified",a),e.inlineCitation&&e.inlineCitation.length>0){var r=h(e.inlineCitation),s=n.removeOuterBrackets(n.replaceQuotesWithPlaceholder(r));i.attr("data-inline-citation",s),o.attr("data-inline-citation",s),o.html(r)}else i.removeAttr("data-inline-citation"),o.removeAttr("data-inline-citation"),o.html("X")})},updateInlineCitationBrackets:function(e){e[0].inlineCitation.toString().length?i.find("[data-inline-cit-autonum]").each(function(){var e=t(this);e.contents().each(function(){var e=t(this);e.is("[data-footnote-id]")||e.is("[data-widget]")||e.hasClass("cke_widget_wrapper")||(3==e[0].nodeType?e[0].textContent=e[0].textContent.replace("[","(").replace("]",")"):e.html(e.html().replace("[","(").replace("]",")")))}),e.attr("data-inline-cit",e.attr("data-inline-cit-autonum")),e.removeAttr("data-inline-cit-autonum")}):i.find("[data-inline-cit]").each(function(){var e=t(this);e.contents().each(function(){var e=t(this);e.is("[data-footnote-id]")||e.is("[data-widget]")||e.hasClass("cke_widget_wrapper")||(3==e[0].nodeType?e[0].textContent=e[0].textContent.replace("(","[").replace(")","]"):e.html(e.html().replace("(","[").replace(")","]")))}),e.attr("data-inline-cit-autonum",e.attr("data-inline-cit")),e.removeAttr("data-inline-cit")})},getExternalIds:function(){return i.find(".footnotes li[data-footnote-id][data-ext-id]").map(function(){return t(this).attr("data-ext-id")}).toArray()||[]},insert:function(e,o,a){this.setCursorBookmark(),n.widgets.focused&&(t('<span class="dummyF">&nbsp;</span>').insertAfter(t(n.widgets.focused.element.$).parent()),this.moveCursorAfterFocusedWidget()),this.removeDataInlineCitElsThatArentMarkers(),this.moveTextOutsideBracketsOutOfDataInlineCitEls(),this.moveTextOutsideBracketsOutOfDataInlineCitAutonumEls(),this.initInlineCitationAndFootnoteData(e,o,a),this.createFootnoteIfDoesntExist(),this.generateInlineCitationHtml(),this.insertInlineCitationAndFormat(),t('<span class="dummyF">&nbsp;</span>').insertAfter(i.find(".sup[data-footnote-id]:contains(X)").closest("[data-inline-cit"+(o?"":"autonum")+"]")),this.reorderMarkers("build"),this.moveCursorAfterFocusedWidget(),n.focus()},initInlineCitationAndFootnoteData:function(t,e,n){o=this.replaceQuotesWithPlaceholder(h(t)),d=this.findFootnote(o),a=e?this.removeOuterBrackets(this.replaceQuotesWithPlaceholder(h(e))):null,c=n,(r=this.cursorTouchingInlineCitation())||(s=this.cursorTouchingInlineCitationAutonum())},createFootnoteIfDoesntExist:function(){d||(d=this.generateFootnoteId(),n.fire("lockSnapshot"),this.addFootnote(this.buildFootnote(d,o,a,c)),n.fire("unlockSnapshot"))},generateInlineCitationHtml:function(){u=(a&&!r?'<span data-inline-cit="'+this.getNextDataInlineCitNum()+'">':"")+(a||s?"":'<span data-inline-cit-autonum="'+this.getNextDataInlineCitAutonumNum()+'">')+(a&&!r?"(":"")+(a||s?"":"[")+'<span class="sup" data-citation="'+o+'" data-footnote-id="'+d+'" data-citation-modified="'+o+'"'+(a?' data-inline-citation="'+a+'"':"")+(c&&c.toString().length?' data-ext-id="'+c+'"':"")+">X</span>"+(a&&!r?")":"")+(a||s?"":"]")+(a&&!r?"</span>":"")+(a||s?"":"</span>")},getNextDataInlineCitNum:function(){var e=0;return i.find("[data-inline-cit]").each(function(){var n=parseInt(t(this).attr("data-inline-cit"));e=n>e?n:e}),e+1},getNextDataInlineCitAutonumNum:function(){var e=0;return i.find("[data-inline-cit-autonum]").each(function(){var n=parseInt(t(this).attr("data-inline-cit-autonum"));e=n>e?n:e}),e+1},insertInlineCitationAndFormat:function(){if(r)this.insertInlineCitationWithinAdjacentGroup();else if(s)this.insertInlineCitationAutonumWithinAdjacentGroup();else{var e=this;i.find(m).each(function(){var n=t(this);return n.replaceWith(u+e.getHtmlWithoutWidgetMarkup(n[0].outerHTML)),!1}),this.moveCursorToCursorBookmark()}i.find(".sup[data-footnote-id]").each(function(){t(this).parent(".cke_widget_wrapper").length||n.widgets.initOn(new CKEDITOR.dom.element(this),"footnotemarker")}),this.updateInlineCitationDataAttrs()},insertInlineCitationWithinAdjacentGroup:function(){var e=[],n=!1,o=t(u),s=t("<div>"+a+"</div>").text();i.find("[data-inline-cit="+r+"] .sup[data-footnote-id]").each(function(){var i=t("<div>"+t(this).attr("data-inline-citation")+"</div>").text();!n&&s&&s<i&&(e.push(o[0]),n=!0),e.push(this)}),n||e.push(o[0]),i.find("[data-inline-cit="+r+"]").first().html("("+e.map(function(t){return t.outerHTML}).join(", ")+")")},insertInlineCitationAutonumWithinAdjacentGroup:function(){var e=[],n=t(u);i.find("[data-inline-cit-autonum="+s+"] .sup[data-footnote-id]").each(function(){e.push(this)}),e.push(n[0]),i.find("[data-inline-cit-autonum="+s+"]").first().html("["+e.map(function(t){return t.outerHTML}).join(", ")+"]")},updateInlineCitationDataAttrs:function(){this.removeDuplicatedDataInlineCitAttributes(),(i=t(n.editable().$)).find(".sup[data-footnote-id]:contains(X)").attr("data-citation",o).attr("data-citation-modified",o),a&&i.find(".sup[data-footnote-id]:contains(X)").attr("data-inline-citation",a)},removeDuplicatedDataInlineCitAttributes:function(){for(var e=1;;){var n=i.find("[data-inline-cit="+e+"]"),o=0;if(n.length<=0)break;n.each(function(){o>0&&t(this).removeAttr("data-inline-cit"),o++}),e++}},cursorTouchingInlineCitation:function(){var t=this.cursorElementInsideCitationBlock("data-inline-cit");if(!t){var e=this.getSiblingsEitherSideOfCursor("data-inline-cit");(t=this.cursorElementAdjacentToCitationBlock(e))||(t=this.cursorAdjacentToCitationSeparatedByZeroSpaceText(e,"data-inline-cit"))}return t},cursorTouchingInlineCitationAutonum:function(){var t=this.cursorElementInsideCitationBlock("data-inline-cit-autonum");if(!t){var e=this.getSiblingsEitherSideOfCursor("data-inline-cit-autonum");(t=this.cursorElementAdjacentToCitationBlock(e))||(t=this.cursorAdjacentToCitationSeparatedByZeroSpaceText(e,"data-inline-cit-autonum"))}return t},cursorElementInsideCitationBlock:function(e){var n=null;return i.find("["+e+"]").each(function(){if(t(this).find(m).length)return n=t(this),!1}),n&&n.length?n.attr(e):null},getSiblingsEitherSideOfCursor:function(e){var n={},o=i.find(m);return n.nextSibling=o[0]&&t(o[0].nextSibling),n.prevSibling=o[0]&&t(o[0].previousSibling),n.nextSiblingInlineCitAttr=n.nextSibling&&n.nextSibling.attr(e),n.prevSiblingInlineCitAttr=n.prevSibling&&n.prevSibling.attr(e),n},cursorElementAdjacentToCitationBlock:function(t){return t.nextSiblingInlineCitAttr||t.prevSiblingInlineCitAttr},cursorAdjacentToCitationSeparatedByZeroSpaceText:function(t,e){for(var n=null,i=["nextSibling","previousSibling"],o=0;o<i.length&&!(n=this.iterateSiblingsUntilInlineCitOrNonZeroTextFound(i[o],t[i[o]]&&t[i[o]][0],e));o++);return n},iterateSiblingsUntilInlineCitOrNonZeroTextFound:function(e,n,i){for(var o=this.zeroLengthStringsRegexp(),a=null;n;){var r=t(n),s=r.attr(i);if(s){a=s;break}if(r.text().replace(o,"").length>0)break;n=n[e]}return a},zeroLengthStringsRegexp:function(){return new RegExp("[\0\b​-‏\ufeff]","g")},findFootnote:function(t){if(!n.footnotesStore)return null;var e=null;for(var i in n.footnotesStore)if(n.footnotesStore.hasOwnProperty(i)&&n.footnotesStore[i]===this.replaceQuotesWithPlaceholder(t)){e=i;break}return e},buildFootnote:function(t,e,i,o){return'<li id="footnote'+(n.config.footnotesPrefix?"-"+n.config.footnotesPrefix:"")+"-"+t+'" data-footnote-id="'+t+'"'+(i?' data-inline-citation="'+i+'"':"")+(o&&o.toString().length?' data-ext-id="'+o+'"':"")+'><span class="cite">'+this.revertQuotesPlaceholder(e)+"</span></li>"},addFootnote:function(e,o){var a=i.find(".footnotes");if(0==a.length){var r=n.config.footnotesTitle?n.config.footnotesTitle:"References",s=i.find(".sup[data-footnotes-heading]").attr("data-footnotes-heading");r=this.revertQuotesPlaceholder(s||r);var d=["<h2>","</h2>"];n.config.footnotesHeaderEls&&(d=n.config.footnotesHeaderEls);var u='<section class="footnotes"><header>'+d[0]+r+d[1]+"</header><ol>"+e+"</ol></section>";i.append(u),i.find("section.footnotes").each(function(){t(this).parent(".cke_widget_wrapper").length||n.widgets.initOn(new CKEDITOR.dom.element(this),"footnotes")})}else o?a.find("ol").html(e):a.find("ol").append(e)},generateFootnoteId:function(){for(var e=Math.random().toString(36).substr(2,5);-1!=t.inArray(e,g);)e=String(this.generateFootnoteId());return g.push(e),e},reorderMarkers:function(e){n.fire("lockSnapshot");var o=n.config.footnotesPrefix?"-"+n.config.footnotesPrefix:"",a={order:[],occurrences:{},originalCitationText:[],inlineCitation:[],modifiedCitationText:[],externalIds:[]},r=this,s=i.find(".sup[data-footnote-id]");if(0==s.length)return i.find(".footnotes").parent().remove(),void n.fire("unlockSnapshot");s.each(function(){0;var e,n=t(this),i=n.attr("data-footnote-id"),s=n.attr("data-citation"),d=n.attr("data-citation-modified"),u=n.attr("data-inline-citation"),c=n.attr("data-ext-id"),l=a.order.indexOf(i);-1==l?(a.order.push(i),a.originalCitationText.push(s),a.modifiedCitationText.push(d),a.inlineCitation.push(u),a.externalIds.push(c),l=a.order.length,a.occurrences[i]=1,e="1"):(l++,a.occurrences[i]++,e=a.occurrences[i]);var f=r.generateMarkerHtml(o,s,d,l,e,i,u,c);t(this).html(f)}),n.footnotesStore={};for(var d,u,c="",l=0,f=a.order.length;l<f;l++)c+=this.buildFootnote(a.order[l],a.modifiedCitationText[l],a.inlineCitation[l],a.externalIds[l]),n.footnotesStore[a.order[l]]=a.originalCitationText[l];for(l in this.addFootnote(c,!0),n.widgets.instances)if("footnotes"===n.widgets.instances[l].name){d=n.widgets.instances[l];break}d&&(l=1,i.find(".footnotes li").each(function(){u=t(this).attr("data-footnote-id"),d.initEditable("footnote_"+l,{selector:"#footnote"+o+"-"+u+" .cite",allowedContent:"a[href]; cite[*](*); span[*](*); em strong i"}),l++})),n.fire("unlockSnapshot")},removeDataInlineCitElsThatArentMarkers:function(){i.find("[data-inline-cit]").each(function(){var e=t(this);e.find(".sup[data-footnote-id]").length||e.replaceWith(e.html())})},moveTextOutsideBracketsOutOfDataInlineCitEls:function(){var e=this;i.find("[data-inline-cit]").each(function(){var n=t(this),i=e.cloneJqueryObject(n),o=e.getChildNodesOf(i),a=e.getChildNodesBefore1stWidgetUpToOpenBracket(o,"("),r=e.joinNodesToHtmlString(a),s=e.getChildNodesAfterLastWidgetUpToCloseBracket(o,")"),d=e.joinNodesToHtmlString(s);e.contentExistsBefore1stWidget(r)?e.removeChildNodesBeforeOpenBracket(i,a):r="",e.contentExistsAfterLastWidget(d)?e.removeChildNodesAfterCloseBracket(i,s):d="",(r.length>0||d.length>0)&&n.replaceWith(r.replace(/\([\s\u0000\u0007\u0008\u001A\u001B\u007F\u200B-\u200F\uFEFF]*$/g,"")+e.getHtmlWithoutWidgetMarkup(i[0].outerHTML)+d.replace(/^[\s\u0000\u0007\u0008\u001A\u001B\u007F\u200B-\u200F\uFEFF]*\)/g,""))})},getHtmlWithoutWidgetMarkup:function(t){return n.dataProcessor.toDataFormat(t,{context:"p"})},moveTextOutsideBracketsOutOfDataInlineCitAutonumEls:function(){var e=this;i.find("[data-inline-cit-autonum]").each(function(){var n=t(this),i=e.cloneJqueryObject(n),o=e.getChildNodesOf(i),a=e.getChildNodesBefore1stWidgetUpToOpenBracket(o,"["),r=e.joinNodesToHtmlString(a),s=e.getChildNodesAfterLastWidgetUpToCloseBracket(o,"]"),d=e.joinNodesToHtmlString(s);e.contentExistsBefore1stAutonumWidget(r)?e.removeChildNodesBeforeOpenAutonumBracket(i,a):r="",e.contentExistsAfterLastAutonumWidget(d)?e.removeChildNodesAfterCloseAutonumBracket(i,s):d="",(r.length>0||d.length>0)&&n.replaceWith(r.replace(/\[[\s\u0000\u0007\u0008\u001A\u001B\u007F\u200B-\u200F\uFEFF]*$/g,"")+e.getHtmlWithoutWidgetMarkup(i[0].outerHTML)+d.replace(/^[\s\u0000\u0007\u0008\u001A\u001B\u007F\u200B-\u200F\uFEFF]*\]/g,""))})},cloneJqueryObject:function(e){return t("<div/>").html(e[0].outerHTML).contents()},getChildNodesOf:function(e){var n=[];return e&&e.length&&e.contents().each(function(){n.push(t(this))}),n},getChildNodesBefore1stWidgetUpToOpenBracket:function(t,e){for(var n=[],i=new RegExp("\\"+e,"g"),o=0;o<t.length&&!t[o].find("[data-widget=footnotemarker]").length&&(n.push(t[o]),!t[o].text().match(i));o++);return n},getChildNodesAfterLastWidgetUpToCloseBracket:function(t,e){for(var n=[],i=new RegExp("\\"+e,"g"),o=t.length-1;o>=0&&!t[o].find("[data-widget=footnotemarker]").length&&(n.push(t[o]),!t[o].text().match(i));o--);return n.reverse()},joinNodesToHtmlString:function(t){return t.map(function(t){return 3==t[0].nodeType?t[0].data:t[0].outerHTML}).join("")},contentExistsBefore1stWidget:function(t){return"("!==t.trim()},contentExistsAfterLastWidget:function(t){return")"!==t.trim()},removeChildNodesBeforeOpenBracket:function(e,n){var i=0;e.contents().each(function(){if(++i>=n.length)return t(this).replaceWith("("),!1;t(this).remove()})},removeChildNodesAfterCloseBracket:function(e,n){var i=0;e.contents().reverse().each(function(){if(++i>=n.length)return t(this).replaceWith(")"),!1;t(this).remove()})},contentExistsBefore1stAutonumWidget:function(t){return"["!==t.trim()},contentExistsAfterLastAutonumWidget:function(t){return"]"!==t.trim()},removeChildNodesBeforeOpenAutonumBracket:function(e,n){var i=0;e.contents().each(function(){if(++i>=n.length)return t(this).replaceWith("["),!1;t(this).remove()})},removeChildNodesAfterCloseAutonumBracket:function(e,n){var i=0;e.contents().reverse().each(function(){if(++i>=n.length)return t(this).replaceWith("]"),!1;t(this).remove()})},generateMarkerHtml:function(t,e,n,i,o,a,r,s){return r?'<span class="inline-citation-before-link"></span><span id="footnote-marker'+t+"-"+a+"-"+o+'" data-citation="'+e+'" data-citation-modified="'+n+'" data-inline-citation="'+(r=this.removeOuterBrackets(r))+'" data-footnote-id="'+a+'"'+(s&&s.toString().length?' data-ext-id="'+s+'"':"")+">"+this.revertQuotesPlaceholder(r)+'</span><span class="inline-citation-after-link"></span>':'<span id="footnote-marker'+t+"-"+a+"-"+o+'" data-citation="'+e+'" data-citation-modified="'+n+'" data-footnote-id="'+a+'"'+(s&&s.toString().length?' data-ext-id="'+s+'"':"")+">"+i+"</span>"},moveCursorAfterFocusedWidget:function(){var e=n.createRange(),o=n.document.find("span.dummyF").getItem(0);e.setStart(o,0),e.setEnd(o,0),n.getSelection().selectRanges([e]),i.find("span.dummyF").each(function(){t(this).remove()})},moveCursorToCursorBookmark:function(){var t=n.createRange(),e=n.document.find(m).getItem(0);e&&(t.setStart(e,0),t.setEnd(e,0),n.getSelection().selectRanges([t]))},replaceQuotesWithPlaceholder:function(t){return t.replace(/"/g,"[!quot!]").replace(/&quot;/g,"[!hquot!]")},revertQuotesPlaceholder:function(t){return t.replace(/\[!hquot!\]/g,"&quot;").replace(/\[!quot!\]/g,'"')},removeOuterBrackets:function(t){return t.replace(/^\s*\({1}\s*/g,"").replace(/\s*\){1}\s*$/g,"")}})}(window.jQuery)}]);