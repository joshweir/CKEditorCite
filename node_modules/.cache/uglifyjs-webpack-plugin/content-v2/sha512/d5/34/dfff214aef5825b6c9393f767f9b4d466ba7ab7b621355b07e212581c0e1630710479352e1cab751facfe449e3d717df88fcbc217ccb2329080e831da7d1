{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";function i(t){return null!=t&&\"object\"==typeof t&&!0===t[\"@@functional/placeholder\"]}function r(t){return function e(n){return 0===arguments.length||i(n)?e:t.apply(this,arguments)}}n.r(e);function o(t){return function e(n,o){switch(arguments.length){case 0:return e;case 1:return i(n)?e:r(function(e){return t(n,e)});default:return i(n)&&i(o)?e:i(n)?r(function(e){return t(e,o)}):i(o)?r(function(e){return t(n,e)}):t(n,o)}}}function a(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,i){return e.apply(this,arguments)};case 4:return function(t,n,i,r){return e.apply(this,arguments)};case 5:return function(t,n,i,r,o){return e.apply(this,arguments)};case 6:return function(t,n,i,r,o,a){return e.apply(this,arguments)};case 7:return function(t,n,i,r,o,a,u){return e.apply(this,arguments)};case 8:return function(t,n,i,r,o,a,u,s){return e.apply(this,arguments)};case 9:return function(t,n,i,r,o,a,u,s,c){return e.apply(this,arguments)};case 10:return function(t,n,i,r,o,a,u,s,c,d){return e.apply(this,arguments)};default:throw new Error(\"First argument to _arity must be a non-negative integer no greater than ten\")}}function u(t,e,n){return function(){for(var r=[],o=0,s=t,c=0;c<e.length||o<arguments.length;){var d;c<e.length&&(!i(e[c])||o>=arguments.length)?d=e[c]:(d=arguments[o],o+=1),r[c]=d,i(d)||(s-=1),c+=1}return s<=0?n.apply(this,r):a(s,u(t,r,n))}}var s=o(function(t,e){return 1===t?r(e):a(t,u(t,[],e))});function c(t){return function e(n,a,u){switch(arguments.length){case 0:return e;case 1:return i(n)?e:o(function(e,i){return t(n,e,i)});case 2:return i(n)&&i(a)?e:i(n)?o(function(e,n){return t(e,a,n)}):i(a)?o(function(e,i){return t(n,e,i)}):r(function(e){return t(n,a,e)});default:return i(n)&&i(a)&&i(u)?e:i(n)&&i(a)?o(function(e,n){return t(e,n,u)}):i(n)&&i(u)?o(function(e,n){return t(e,a,n)}):i(a)&&i(u)?o(function(e,i){return t(n,e,i)}):i(n)?r(function(e){return t(e,a,u)}):i(a)?r(function(e){return t(n,e,u)}):i(u)?r(function(e){return t(n,a,e)}):t(n,a,u)}}}var d=Array.isArray||function(t){return null!=t&&t.length>=0&&\"[object Array]\"===Object.prototype.toString.call(t)};function l(t){return\"[object String]\"===Object.prototype.toString.call(t)}var f=r(function(t){return!!d(t)||!!t&&(\"object\"==typeof t&&(!l(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),h=function(){function t(t){this.f=t}return t.prototype[\"@@transducer/init\"]=function(){throw new Error(\"init not implemented on XWrap\")},t.prototype[\"@@transducer/result\"]=function(t){return t},t.prototype[\"@@transducer/step\"]=function(t,e){return this.f(t,e)},t}();function p(t){return new h(t)}var g=o(function(t,e){return a(t.length,function(){return t.apply(e,arguments)})});function m(t,e,n){for(var i=n.next();!i.done;){if((e=t[\"@@transducer/step\"](e,i.value))&&e[\"@@transducer/reduced\"]){e=e[\"@@transducer/value\"];break}i=n.next()}return t[\"@@transducer/result\"](e)}function v(t,e,n,i){return t[\"@@transducer/result\"](n[i](g(t[\"@@transducer/step\"],t),e))}var C=\"undefined\"!=typeof Symbol?Symbol.iterator:\"@@iterator\";function y(t,e,n){if(\"function\"==typeof t&&(t=p(t)),f(n))return function(t,e,n){for(var i=0,r=n.length;i<r;){if((e=t[\"@@transducer/step\"](e,n[i]))&&e[\"@@transducer/reduced\"]){e=e[\"@@transducer/value\"];break}i+=1}return t[\"@@transducer/result\"](e)}(t,e,n);if(\"function\"==typeof n[\"fantasy-land/reduce\"])return v(t,e,n,\"fantasy-land/reduce\");if(null!=n[C])return m(t,e,n[C]());if(\"function\"==typeof n.next)return m(t,e,n);if(\"function\"==typeof n.reduce)return v(t,e,n,\"reduce\");throw new TypeError(\"reduce: list must be array or iterable\")}function k(t,e){return Object.prototype.hasOwnProperty.call(e,t)}var x=Object.prototype.toString,b=function(){return\"[object Arguments]\"===x.call(arguments)?function(t){return\"[object Arguments]\"===x.call(t)}:function(t){return k(\"callee\",t)}},I=!{toString:null}.propertyIsEnumerable(\"toString\"),A=[\"constructor\",\"valueOf\",\"isPrototypeOf\",\"toString\",\"propertyIsEnumerable\",\"hasOwnProperty\",\"toLocaleString\"],S=function(){return arguments.propertyIsEnumerable(\"length\")}(),O=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},E=(Object.keys,c(y));Number.isInteger;var T=r(function(t){return s(t.length,t)});function B(t,e){return function(){return e.call(this,t.apply(this,arguments))}}function w(t,e){return function(){var n=arguments.length;if(0===n)return e();var i=arguments[n-1];return d(i)||\"function\"!=typeof i[t]?e.apply(this,arguments):i[t].apply(i,Array.prototype.slice.call(arguments,0,n-1))}}var W=c(w(\"slice\",function(t,e,n){return Array.prototype.slice.call(n,t,e)})),F=r(w(\"tail\",W(1,1/0)));var j=r(function(t){return l(t)?t.split(\"\").reverse().join(\"\"):Array.prototype.slice.call(t,0).reverse()});function D(){if(0===arguments.length)throw new Error(\"compose requires at least one argument\");return function(){if(0===arguments.length)throw new Error(\"pipe requires at least one argument\");return a(arguments[0].length,E(B,arguments[0],F(arguments)))}.apply(this,j(arguments))}var M=function(t){return(t<10?\"0\":\"\")+t};Date.prototype.toISOString;function N(t){return t}var R=\"function\"==typeof Object.assign?Object.assign:function(t){if(null==t)throw new TypeError(\"Cannot convert undefined or null to object\");for(var e=Object(t),n=1,i=arguments.length;n<i;){var r=arguments[n];if(null!=r)for(var o in r)k(o,r)&&(e[o]=r[o]);n+=1}return e},P=o(function(t,e){var n={};return n[t]=e,n});Array,String,Object;var _,H,q,L,Q,$,K,U,X,G,Z,J,V,z,Y=\"\\t\\n\\v\\f\\r   ᠎             　\\u2028\\u2029\\ufeff\";String.prototype.trim;_=window.jQuery,Z=T(function(t,e,n){return n.replace(e,t)}),J=function(t){return e=\"span\",n=\"div\",i=t,r=new RegExp(\"<\"+n,\"g\"),o=\"<\"+e,a=new RegExp(\"</\"+n,\"g\"),u=\"</\"+e,s=Z(o)(r),D(Z(u)(a),s)(i);var e,n,i,r,o,a,u,s},V=[],z=\"[data-selection-bookmark]\",jQuery.fn.reverse=[].reverse,CKEDITOR.plugins.add(\"cite\",{requires:\"widget,contextmenu,wysiwygarea,dialogui,dialog,basicstyles,menu,contextmenu,floatpanel,panel\",icons:\"cite\",init:function(t){if(void 0===window.jQuery)return console.warn(\"jQuery required but undetected so quitting cite.\"),!1;CKEDITOR.dtd.$editable.span=1,(H=t).addContentsCss(this.path+\"styles/plugin.css\"),this.initWidgets(),this.setupEditorEventHandlers()},initWidgets:function(){this.registerWidgets(),this.addWidgetCommandsButtonsAndDialogs()},registerWidgets:function(){H.widgets.add(\"footnotes\",{requiredContent:\"section(footnotes)\",upcast:function(t){return\"section\"===t.name&&t.hasClass(\"footnotes\")},editables:this.retrieveFootnotesWidgetEditableElements(_(\"<div>\"+H.element.$.textContent+\"</div>\")),draggable:!1}),H.widgets.add(\"footnotemarker\",{requiredContent:\"span[data-citation]\",upcast:function(t){return t.classes.indexOf(\"sup\")>-1&&\"undefined\"!=t.attributes[\"data-footnote-id\"]},draggable:!1})},retrieveFootnotesWidgetEditableElements:function(t){var e={header:{selector:\"header > *\",allowedContent:\"span[*](*); strong em sub sup;div[*](sup)\"}},n=1,i=H.config.footnotesPrefix?\"-\"+H.config.footnotesPrefix:\"\";return t.find(\".footnotes li\").each(function(){e[\"footnote_\"+n]={selector:\"#footnote\"+i+\"-\"+_(this).attr(\"data-footnote-id\")+\" .cite\",allowedContent:\"a[href]; cite[*](*); span[*](*); strong em br i\"},n++}),e},addWidgetCommandsButtonsAndDialogs:function(){H.addCommand(\"cite\",new CKEDITOR.dialogCommand(\"citeDialog\",{allowedContent:\"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)\",requiredContent:\"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)\"})),H.addCommand(\"intext_cite\",new CKEDITOR.dialogCommand(\"intextCiteDialog\",{allowedContent:\"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)\",requiredContent:\"section[*](*);header[*](*);li[*];a[*];cite(*)[*];sup[*];div[*](sup)\"})),H.ui.addButton(\"Cite\",{label:\"Insert Citation\",command:\"cite\",toolbar:\"insert\"}),CKEDITOR.dialog.add(\"citeDialog\",this.path+\"dialogs/cite.js\"),CKEDITOR.dialog.add(\"intextCiteDialog\",this.path+\"dialogs/intext_cite.js\")},setupEditorEventHandlers:function(){this.retrieveContentsAndReorderMarkersOnInstanceReady(),this.moveCursorAfterFocusedWidgetOnEditorBlur(),this.reorderMarkersOnEditorChange(),this.updateMarkersWithCurrentCitationValuesOnEditorChange(),this.invokeIntextCiteDialogOnDoubleClick(),this.initMenuOnInstanceReady()},retrieveContentsAndReorderMarkersOnInstanceReady:function(){var t=this;H.on(\"instanceReady\",function(e){q=_(H.editable().$),t.reorderMarkers(\"startup\"),q=_(H.editable().$)})},moveCursorAfterFocusedWidgetOnEditorBlur:function(){H.on(\"blur\",function(){H.widgets.focused&&(_('<span class=\"dummyF\">&nbsp;</span>').insertAfter(_(H.widgets.focused.element.$).parent()),this.moveCursorAfterFocusedWidget())})},reorderMarkersOnEditorChange:function(){var t,e=this;H.on(\"change\",function(n){clearTimeout(t),t=setTimeout(function(){var t=(new Date).getTime();localStorage.getItem(\"reordering_markers\")||localStorage.setItem(\"reordering_markers\",t),n.editor.getSelection()&&n.editor.getSelection().getStartElement()&&(e.editingAFootnote(n)||(localStorage.getItem(\"reordering_markers\")==t&&setTimeout(function(){e.reorderMarkers(\"change\")},0),setTimeout(function(){localStorage.removeItem(\"reordering_markers\")},200)))},1e3)})},editingAFootnote:function(t){var e=t.editor.getSelection().getStartElement().getAscendant(\"section\");return!(!e||-1===e.$.className.indexOf(\"footnotes\"))},updateMarkersWithCurrentCitationValuesOnEditorChange:function(){var t=this;H.on(\"change\",function(e){var n=q.find(\".footnotes header h2\").html();q.find(\".footnotes li .cite\").each(function(){var e=_(this),i=_(this).parent(\"li\").attr(\"data-footnote-id\");q.find(\".sup[data-footnote-id=\"+i+\"]\").each(function(){_(this).attr(\"data-citation-modified\",t.replaceQuotesWithPlaceholder(e.html())),n&&_(this).attr(\"data-footnotes-heading\",t.replaceQuotesWithPlaceholder(n))})})})},invokeIntextCiteDialogOnDoubleClick:function(){H.on(\"doubleclick\",function(t){var e=H.getSelection().getStartElement();e.hasClass(\"cke_widget_focused\")&&e.find(\".sup[data-footnote-id]\").$.length&&H.execCommand(\"intext_cite\")})},initMenuOnInstanceReady:function(){CKEDITOR.on(\"instanceReady\",function(t){H._.menuItems.editCiteCmd||(H.addMenuGroup(\"cite\"),H.contextMenu.addListener(function(t,e){if(t.getAscendant(function(t){try{return t.hasClass(\"cke_widget_focused\")&&t.find(\".sup[data-footnote-id]\").$.length}catch(t){return null}},!0))return{editCiteCmd:CKEDITOR.TRISTATE_ON}}),H.addMenuItems({editCiteCmd:{label:\"Edit In-text Citation\",command:\"intext_cite\",group:\"cite\",order:2}}),H.removeMenuItem(\"paste\"),H.removeMenuItem(\"copy\"),H.removeMenuItem(\"cut\"))})},setCursorBookmark:function(){if(H&&q)return this.removeExistingCursorBookmark(),this.createCursorBookmarkReturnContainingElement()},removeExistingCursorBookmark:function(){q.find(z).remove(),q.find(\"span\").filter(function(){return\"&nbsp;\"===_(this).html()}).remove()},createCursorBookmarkReturnContainingElement:function(){var t=H.getSelection(),e=t.createBookmarks();return e[0]&&_(e[0].startNode.$).attr(\"data-selection-bookmark\",\"1\"),t.getRanges()[0]},isValidHtml:function(t){return!0},updateCitationsByExternalId:function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)this.citationUpdateHasRequiredData(t[e])&&(this.updateFootnotesByExternalId(t[e]),this.updateInlineCitationsByExternalId(t[e]));t.length&&this.updateInlineCitationBrackets(t),this.reorderMarkers(\"build\"),H.focus()}},citationUpdateHasRequiredData:function(t){return t instanceof Object&&t.externalId&&t.externalId.length>0&&t.citation&&t.citation.length>0},updateFootnotesByExternalId:function(t){var e=this;q.find(\".footnotes li[data-footnote-id][data-ext-id=\"+t.externalId+\"]\").each(function(){var n=_(this);t.inlineCitation&&t.inlineCitation.length>0?n.attr(\"data-inline-citation\",e.removeOuterBrackets(e.replaceQuotesWithPlaceholder(J(t.inlineCitation)))):n.removeAttr(\"data-inline-citation\"),n.find(\".cite\").html(J(t.citation))})},updateInlineCitationsByExternalId:function(t){var e=this;q.find(\".sup[data-footnote-id][data-ext-id=\"+t.externalId+\"]\").each(function(){var n=_(this),i=n.find(\"a\"),r=e.replaceQuotesWithPlaceholder(J(t.citation));if(n.attr(\"data-citation\",r).attr(\"data-citation-modified\",r),i.attr(\"data-citation\",r).attr(\"data-citation-modified\",r),t.inlineCitation&&t.inlineCitation.length>0){var o=J(t.inlineCitation),a=e.removeOuterBrackets(e.replaceQuotesWithPlaceholder(o));n.attr(\"data-inline-citation\",a),i.attr(\"data-inline-citation\",a),i.html(o)}else n.removeAttr(\"data-inline-citation\"),i.removeAttr(\"data-inline-citation\"),i.html(\"X\")})},updateInlineCitationBrackets:function(t){t[0].inlineCitation.toString().length?q.find(\"[data-inline-cit-autonum]\").each(function(){var t=_(this);t.contents().each(function(){var t=_(this);t.is(\"[data-footnote-id]\")||t.is(\"[data-widget]\")||t.hasClass(\"cke_widget_wrapper\")||(3==t[0].nodeType?t[0].textContent=t[0].textContent.replace(\"[\",\"(\").replace(\"]\",\")\"):t.html(t.html().replace(\"[\",\"(\").replace(\"]\",\")\")))}),t.attr(\"data-inline-cit\",t.attr(\"data-inline-cit-autonum\")),t.removeAttr(\"data-inline-cit-autonum\")}):q.find(\"[data-inline-cit]\").each(function(){var t=_(this);t.contents().each(function(){var t=_(this);t.is(\"[data-footnote-id]\")||t.is(\"[data-widget]\")||t.hasClass(\"cke_widget_wrapper\")||(3==t[0].nodeType?t[0].textContent=t[0].textContent.replace(\"(\",\"[\").replace(\")\",\"]\"):t.html(t.html().replace(\"(\",\"[\").replace(\")\",\"]\")))}),t.attr(\"data-inline-cit-autonum\",t.attr(\"data-inline-cit\")),t.removeAttr(\"data-inline-cit\")})},getExternalIds:function(){return q.find(\".footnotes li[data-footnote-id][data-ext-id]\").map(function(){return _(this).attr(\"data-ext-id\")}).toArray()||[]},insert:function(t,e,n){this.setCursorBookmark(),H.widgets.focused&&(_('<span class=\"dummyF\">&nbsp;</span>').insertAfter(_(H.widgets.focused.element.$).parent()),this.moveCursorAfterFocusedWidget()),this.removeDataInlineCitElsThatArentMarkers(),this.moveTextOutsideBracketsOutOfDataInlineCitEls(),this.moveTextOutsideBracketsOutOfDataInlineCitAutonumEls(),this.initInlineCitationAndFootnoteData(t,e,n),this.createFootnoteIfDoesntExist(),this.generateInlineCitationHtml(),this.insertInlineCitationAndFormat(),_('<span class=\"dummyF\">&nbsp;</span>').insertAfter(q.find(\".sup[data-footnote-id]:contains(X)\").closest(\"[data-inline-cit\"+(e?\"\":\"autonum\")+\"]\")),this.reorderMarkers(\"build\"),this.moveCursorAfterFocusedWidget(),H.focus()},initInlineCitationAndFootnoteData:function(t,e,n){L=this.replaceQuotesWithPlaceholder(J(t)),U=this.findFootnote(L),Q=e?this.removeOuterBrackets(this.replaceQuotesWithPlaceholder(J(e))):null,G=n,($=this.cursorTouchingInlineCitation())||(K=this.cursorTouchingInlineCitationAutonum())},createFootnoteIfDoesntExist:function(){U||(U=this.generateFootnoteId(),H.fire(\"lockSnapshot\"),this.addFootnote(this.buildFootnote(U,L,Q,G)),H.fire(\"unlockSnapshot\"))},generateInlineCitationHtml:function(){X=(Q&&!$?'<span data-inline-cit=\"'+this.getNextDataInlineCitNum()+'\">':\"\")+(Q||K?\"\":'<span data-inline-cit-autonum=\"'+this.getNextDataInlineCitAutonumNum()+'\">')+(Q&&!$?\"(\":\"\")+(Q||K?\"\":\"[\")+'<span class=\"sup\" data-citation=\"'+L+'\" data-footnote-id=\"'+U+'\" data-citation-modified=\"'+L+'\"'+(Q?' data-inline-citation=\"'+Q+'\"':\"\")+(G&&G.toString().length?' data-ext-id=\"'+G+'\"':\"\")+\">X</span>\"+(Q&&!$?\")\":\"\")+(Q||K?\"\":\"]\")+(Q&&!$?\"</span>\":\"\")+(Q||K?\"\":\"</span>\")},getNextDataInlineCitNum:function(){var t=0;return q.find(\"[data-inline-cit]\").each(function(){var e=parseInt(_(this).attr(\"data-inline-cit\"));t=e>t?e:t}),t+1},getNextDataInlineCitAutonumNum:function(){var t=0;return q.find(\"[data-inline-cit-autonum]\").each(function(){var e=parseInt(_(this).attr(\"data-inline-cit-autonum\"));t=e>t?e:t}),t+1},insertInlineCitationAndFormat:function(){if($)this.insertInlineCitationWithinAdjacentGroup();else if(K)this.insertInlineCitationAutonumWithinAdjacentGroup();else{var t=this;q.find(z).each(function(){var e=_(this);return e.replaceWith(X+t.getHtmlWithoutWidgetMarkup(e[0].outerHTML)),!1}),this.moveCursorToCursorBookmark()}q.find(\".sup[data-footnote-id]\").each(function(){_(this).parent(\".cke_widget_wrapper\").length||H.widgets.initOn(new CKEDITOR.dom.element(this),\"footnotemarker\")}),this.updateInlineCitationDataAttrs()},insertInlineCitationWithinAdjacentGroup:function(){var t=[],e=!1,n=_(X),i=_(\"<div>\"+Q+\"</div>\").text();q.find(\"[data-inline-cit=\"+$+\"] .sup[data-footnote-id]\").each(function(){var r=_(\"<div>\"+_(this).attr(\"data-inline-citation\")+\"</div>\").text();!e&&i&&i<r&&(t.push(n[0]),e=!0),t.push(this)}),e||t.push(n[0]),q.find(\"[data-inline-cit=\"+$+\"]\").first().html(\"(\"+t.map(function(t){return t.outerHTML}).join(\", \")+\")\")},insertInlineCitationAutonumWithinAdjacentGroup:function(){var t=[],e=_(X);q.find(\"[data-inline-cit-autonum=\"+K+\"] .sup[data-footnote-id]\").each(function(){t.push(this)}),t.push(e[0]),q.find(\"[data-inline-cit-autonum=\"+K+\"]\").first().html(\"[\"+t.map(function(t){return t.outerHTML}).join(\", \")+\"]\")},updateInlineCitationDataAttrs:function(){this.removeDuplicatedDataInlineCitAttributes(),(q=_(H.editable().$)).find(\".sup[data-footnote-id]:contains(X)\").attr(\"data-citation\",L).attr(\"data-citation-modified\",L),Q&&q.find(\".sup[data-footnote-id]:contains(X)\").attr(\"data-inline-citation\",Q)},removeDuplicatedDataInlineCitAttributes:function(){for(var t=1;;){var e=q.find(\"[data-inline-cit=\"+t+\"]\"),n=0;if(e.length<=0)break;e.each(function(){n>0&&_(this).removeAttr(\"data-inline-cit\"),n++}),t++}},cursorTouchingInlineCitation:function(){var t=this.cursorElementInsideCitationBlock(\"data-inline-cit\");if(!t){var e=this.getSiblingsEitherSideOfCursor(\"data-inline-cit\");(t=this.cursorElementAdjacentToCitationBlock(e))||(t=this.cursorAdjacentToCitationSeparatedByZeroSpaceText(e,\"data-inline-cit\"))}return t},cursorTouchingInlineCitationAutonum:function(){var t=this.cursorElementInsideCitationBlock(\"data-inline-cit-autonum\");if(!t){var e=this.getSiblingsEitherSideOfCursor(\"data-inline-cit-autonum\");(t=this.cursorElementAdjacentToCitationBlock(e))||(t=this.cursorAdjacentToCitationSeparatedByZeroSpaceText(e,\"data-inline-cit-autonum\"))}return t},cursorElementInsideCitationBlock:function(t){var e=null;return q.find(\"[\"+t+\"]\").each(function(){if(_(this).find(z).length)return e=_(this),!1}),e&&e.length?e.attr(t):null},getSiblingsEitherSideOfCursor:function(t){var e={},n=q.find(z);return e.nextSibling=n[0]&&_(n[0].nextSibling),e.prevSibling=n[0]&&_(n[0].previousSibling),e.nextSiblingInlineCitAttr=e.nextSibling&&e.nextSibling.attr(t),e.prevSiblingInlineCitAttr=e.prevSibling&&e.prevSibling.attr(t),e},cursorElementAdjacentToCitationBlock:function(t){return t.nextSiblingInlineCitAttr||t.prevSiblingInlineCitAttr},cursorAdjacentToCitationSeparatedByZeroSpaceText:function(t,e){for(var n=null,i=[\"nextSibling\",\"previousSibling\"],r=0;r<i.length&&!(n=this.iterateSiblingsUntilInlineCitOrNonZeroTextFound(i[r],t[i[r]]&&t[i[r]][0],e));r++);return n},iterateSiblingsUntilInlineCitOrNonZeroTextFound:function(t,e,n){for(var i=this.zeroLengthStringsRegexp(),r=null;e;){var o=_(e),a=o.attr(n);if(a){r=a;break}if(o.text().replace(i,\"\").length>0)break;e=e[t]}return r},zeroLengthStringsRegexp:function(){return new RegExp(\"[\\0\u0007\\b\u001a\u001b​-‏\\ufeff]\",\"g\")},findFootnote:function(t){if(!H.footnotesStore)return null;var e=null;for(var n in H.footnotesStore)if(H.footnotesStore.hasOwnProperty(n)&&H.footnotesStore[n]===this.replaceQuotesWithPlaceholder(t)){e=n;break}return e},buildFootnote:function(t,e,n,i){return'<li id=\"footnote'+(H.config.footnotesPrefix?\"-\"+H.config.footnotesPrefix:\"\")+\"-\"+t+'\" data-footnote-id=\"'+t+'\"'+(n?' data-inline-citation=\"'+n+'\"':\"\")+(i&&i.toString().length?' data-ext-id=\"'+i+'\"':\"\")+'><span class=\"cite\">'+this.revertQuotesPlaceholder(e)+\"</span></li>\"},addFootnote:function(t,e){var n=q.find(\".footnotes\");if(0==n.length){var i=H.config.footnotesTitle?H.config.footnotesTitle:\"References\",r=q.find(\".sup[data-footnotes-heading]\").attr(\"data-footnotes-heading\");i=this.revertQuotesPlaceholder(r||i);var o=[\"<h2>\",\"</h2>\"];H.config.footnotesHeaderEls&&(o=H.config.footnotesHeaderEls);var a='<section class=\"footnotes\"><header>'+o[0]+i+o[1]+\"</header><ol>\"+t+\"</ol></section>\";q.append(a),q.find(\"section.footnotes\").each(function(){_(this).parent(\".cke_widget_wrapper\").length||H.widgets.initOn(new CKEDITOR.dom.element(this),\"footnotes\")})}else e?n.find(\"ol\").html(t):n.find(\"ol\").append(t)},generateFootnoteId:function(){for(var t=Math.random().toString(36).substr(2,5);-1!=_.inArray(t,V);)t=String(this.generateFootnoteId());return V.push(t),t},reorderMarkers:function(t){H.fire(\"lockSnapshot\");var e=H.config.footnotesPrefix?\"-\"+H.config.footnotesPrefix:\"\",n={order:[],occurrences:{},originalCitationText:[],inlineCitation:[],modifiedCitationText:[],externalIds:[]},i=this,r=q.find(\".sup[data-footnote-id]\");if(0==r.length)return q.find(\".footnotes\").parent().remove(),void H.fire(\"unlockSnapshot\");r.each(function(){var t,r=_(this),o=r.attr(\"data-footnote-id\"),a=r.attr(\"data-citation\"),u=r.attr(\"data-citation-modified\"),s=r.attr(\"data-inline-citation\"),c=r.attr(\"data-ext-id\"),d=n.order.indexOf(o);-1==d?(n.order.push(o),n.originalCitationText.push(a),n.modifiedCitationText.push(u),n.inlineCitation.push(s),n.externalIds.push(c),d=n.order.length,n.occurrences[o]=1,t=\"1\"):(d++,n.occurrences[o]++,t=n.occurrences[o]);var l=i.generateMarkerHtml(e,a,u,d,t,o,s,c);_(this).html(l)}),H.footnotesStore={};for(var o,a,u=\"\",s=0,c=n.order.length;s<c;s++)u+=this.buildFootnote(n.order[s],n.modifiedCitationText[s],n.inlineCitation[s],n.externalIds[s]),H.footnotesStore[n.order[s]]=n.originalCitationText[s];for(s in this.addFootnote(u,!0),H.widgets.instances)if(\"footnotes\"===H.widgets.instances[s].name){o=H.widgets.instances[s];break}o&&(s=1,q.find(\".footnotes li\").each(function(){a=_(this).attr(\"data-footnote-id\"),o.initEditable(\"footnote_\"+s,{selector:\"#footnote\"+e+\"-\"+a+\" .cite\",allowedContent:\"a[href]; cite[*](*); span[*](*); em strong i\"}),s++})),H.fire(\"unlockSnapshot\")},removeDataInlineCitElsThatArentMarkers:function(){q.find(\"[data-inline-cit]\").each(function(){var t=_(this);t.find(\".sup[data-footnote-id]\").length||t.replaceWith(t.html())})},moveTextOutsideBracketsOutOfDataInlineCitEls:function(){var t=this;q.find(\"[data-inline-cit]\").each(function(){var e=_(this),n=t.cloneJqueryObject(e),i=t.getChildNodesOf(n),r=t.getChildNodesBefore1stWidgetUpToOpenBracket(i,\"(\"),o=t.joinNodesToHtmlString(r),a=t.getChildNodesAfterLastWidgetUpToCloseBracket(i,\")\"),u=t.joinNodesToHtmlString(a);t.contentExistsBefore1stWidget(o)?t.removeChildNodesBeforeOpenBracket(n,r):o=\"\",t.contentExistsAfterLastWidget(u)?t.removeChildNodesAfterCloseBracket(n,a):u=\"\",(o.length>0||u.length>0)&&e.replaceWith(o.replace(/\\([\\s\\u0000\\u0007\\u0008\\u001A\\u001B\\u007F\\u200B-\\u200F\\uFEFF]*$/g,\"\")+t.getHtmlWithoutWidgetMarkup(n[0].outerHTML)+u.replace(/^[\\s\\u0000\\u0007\\u0008\\u001A\\u001B\\u007F\\u200B-\\u200F\\uFEFF]*\\)/g,\"\"))})},getHtmlWithoutWidgetMarkup:function(t){return H.dataProcessor.toDataFormat(t,{context:\"p\"})},moveTextOutsideBracketsOutOfDataInlineCitAutonumEls:function(){var t=this;q.find(\"[data-inline-cit-autonum]\").each(function(){var e=_(this),n=t.cloneJqueryObject(e),i=t.getChildNodesOf(n),r=t.getChildNodesBefore1stWidgetUpToOpenBracket(i,\"[\"),o=t.joinNodesToHtmlString(r),a=t.getChildNodesAfterLastWidgetUpToCloseBracket(i,\"]\"),u=t.joinNodesToHtmlString(a);t.contentExistsBefore1stAutonumWidget(o)?t.removeChildNodesBeforeOpenAutonumBracket(n,r):o=\"\",t.contentExistsAfterLastAutonumWidget(u)?t.removeChildNodesAfterCloseAutonumBracket(n,a):u=\"\",(o.length>0||u.length>0)&&e.replaceWith(o.replace(/\\[[\\s\\u0000\\u0007\\u0008\\u001A\\u001B\\u007F\\u200B-\\u200F\\uFEFF]*$/g,\"\")+t.getHtmlWithoutWidgetMarkup(n[0].outerHTML)+u.replace(/^[\\s\\u0000\\u0007\\u0008\\u001A\\u001B\\u007F\\u200B-\\u200F\\uFEFF]*\\]/g,\"\"))})},cloneJqueryObject:function(t){return _(\"<div/>\").html(t[0].outerHTML).contents()},getChildNodesOf:function(t){var e=[];return t&&t.length&&t.contents().each(function(){e.push(_(this))}),e},getChildNodesBefore1stWidgetUpToOpenBracket:function(t,e){for(var n=[],i=new RegExp(\"\\\\\"+e,\"g\"),r=0;r<t.length&&!t[r].find(\"[data-widget=footnotemarker]\").length&&(n.push(t[r]),!t[r].text().match(i));r++);return n},getChildNodesAfterLastWidgetUpToCloseBracket:function(t,e){for(var n=[],i=new RegExp(\"\\\\\"+e,\"g\"),r=t.length-1;r>=0&&!t[r].find(\"[data-widget=footnotemarker]\").length&&(n.push(t[r]),!t[r].text().match(i));r--);return n.reverse()},joinNodesToHtmlString:function(t){return t.map(function(t){return 3==t[0].nodeType?t[0].data:t[0].outerHTML}).join(\"\")},contentExistsBefore1stWidget:function(t){return\"(\"!==t.trim()},contentExistsAfterLastWidget:function(t){return\")\"!==t.trim()},removeChildNodesBeforeOpenBracket:function(t,e){var n=0;t.contents().each(function(){if(++n>=e.length)return _(this).replaceWith(\"(\"),!1;_(this).remove()})},removeChildNodesAfterCloseBracket:function(t,e){var n=0;t.contents().reverse().each(function(){if(++n>=e.length)return _(this).replaceWith(\")\"),!1;_(this).remove()})},contentExistsBefore1stAutonumWidget:function(t){return\"[\"!==t.trim()},contentExistsAfterLastAutonumWidget:function(t){return\"]\"!==t.trim()},removeChildNodesBeforeOpenAutonumBracket:function(t,e){var n=0;t.contents().each(function(){if(++n>=e.length)return _(this).replaceWith(\"[\"),!1;_(this).remove()})},removeChildNodesAfterCloseAutonumBracket:function(t,e){var n=0;t.contents().reverse().each(function(){if(++n>=e.length)return _(this).replaceWith(\"]\"),!1;_(this).remove()})},generateMarkerHtml:function(t,e,n,i,r,o,a,u){return a?'<span class=\"inline-citation-before-link\"></span><span id=\"footnote-marker'+t+\"-\"+o+\"-\"+r+'\" data-citation=\"'+e+'\" data-citation-modified=\"'+n+'\" data-inline-citation=\"'+(a=this.removeOuterBrackets(a))+'\" data-footnote-id=\"'+o+'\"'+(u&&u.toString().length?' data-ext-id=\"'+u+'\"':\"\")+\">\"+this.revertQuotesPlaceholder(a)+'</span><span class=\"inline-citation-after-link\"></span>':'<span id=\"footnote-marker'+t+\"-\"+o+\"-\"+r+'\" data-citation=\"'+e+'\" data-citation-modified=\"'+n+'\" data-footnote-id=\"'+o+'\"'+(u&&u.toString().length?' data-ext-id=\"'+u+'\"':\"\")+\">\"+i+\"</span>\"},moveCursorAfterFocusedWidget:function(){var t=H.createRange(),e=H.document.find(\"span.dummyF\").getItem(0);t.setStart(e,0),t.setEnd(e,0),H.getSelection().selectRanges([t]),q.find(\"span.dummyF\").each(function(){_(this).remove()})},moveCursorToCursorBookmark:function(){var t=H.createRange(),e=H.document.find(z).getItem(0);e&&(t.setStart(e,0),t.setEnd(e,0),H.getSelection().selectRanges([t]))},replaceQuotesWithPlaceholder:function(t){return t.replace(/\"/g,\"[!quot!]\").replace(/&quot;/g,\"[!hquot!]\")},revertQuotesPlaceholder:function(t){return t.replace(/\\[!hquot!\\]/g,\"&quot;\").replace(/\\[!quot!\\]/g,'\"')},removeOuterBrackets:function(t){return t.replace(/^\\s*\\({1}\\s*/g,\"\").replace(/\\s*\\){1}\\s*$/g,\"\")}})}]);","extractedComments":[]}